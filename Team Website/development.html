<!DOCTYPE HTML>
<!--
	Spectral by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Development - iNRIC</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="assets/css/main.css" />
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
		<!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
	</head>
	<body>

		<!-- Page Wrapper -->
			<div id="page-wrapper">

				<!-- Header -->
					<header id="header">
						<h1><a href="index.html">iNRIC</a></h1>
						<nav id="nav">
							<ul>
								<li class="special">
									<a href="#menu" class="menuToggle"><span>Menu</span></a>
									<div id="menu">
										<ul>
											<li><a href="index.html">Home</a></li>
											<li><a href="overview.html">Overview</a></li>
											<li><a href="research.html">Research</a></li>
											<li><a href="development.html">Development</a></li>
											<li><a href="testing.html">Testing</a></li>
											<li><a href="progress.html">Progress</a></li>
											<li><a href="further_dev.html">Further Dev</a></li>
										</ul>
									</div>
								</li>
							</ul>
						</nav>
					</header>

				<!-- Main -->
					<article id="main">
						<header>
							<h2>Development</h2>
							<p>Repository, Prototype, Prototype installation <br />Architectural Diagram, Development Plan, Iterations and Forks in prototypes <br /> Technical achievements, implementation details, use of design patterns</p>
						</header>
						<section class="wrapper style5">
							<div class="inner">

								<h3>Repository</h3>
								<p> Our repository of choice is Github. </p>
								<ul class="actions">
									
										<li><a href="https://github.com/andyboscor/nric_dev.git" class="button special">Github</a></li>
									
									</ul>
								<hr />

								<h3> Mock-ups </h3>
								<p> We only created a few photoshop mock-ups to showcase the look and feel of the application as our client wanted to begin development of the app as soon as possible. </p>
								<p> Home page and notifications </p>
								<div class="box alt">
										<div class="row uniform 50%">
											<div class="4u"><span class="image fit"><img src="images/WHO2.jpg" alt="" /></span></div>
											<div class="4u"><span class="image fit"><img src="images/notification.jpg" alt="" /></span></div>
											<div class="4u"><span class="image fit"><img src="images/notificationin.jpg" alt="" /></span></div>
										</div>
	
								</div>
								<hr />

								<h3>Prototype</h3>

								<p> The protoype below is the web version of the application. It behaves mainly like the App would.</p>

								<p> To login type team42 and password 123456.</p>

								<p> On some browsers, the website template javascript affects the application therefore the application might seem to jump around the web page. If this happens please visit the link below to see the app in a separate page.
								<a href="prototype.html">(Link to online prototype)</a> </p>

								<iframe src="iNRIC/www/login.html" width=375 height=667></iframe>
								
								<hr />
								<h3>Prototype installation</h3>
								<p> To install the prototype on any iOS and Android device please follow this quick tutorial </p>
								<ul>
									<li> Download the iNRIC folder from the Github repository </li>
									<li> Install Phonegap CLI via terminal <a href="http://docs.phonegap.com/getting-started/1-install-phonegap/cli/"> (How to) </a> </li>
									<li> Use "cd" to get to the iNRIC folder through Terminal </li>
									<li> Write "phonegap serve" in Terminal </li>
									<li> Install PhoneGap Developer on your iOS or Android Device from the App Store or Google Play </li>
									<li> Open PhoneGap Developer and input the IP adress shown on terminal </li>
									<li> Press connect and wait </li>
								</ul>
								
								<hr />
								<h3>Architectural Diagram</h3>
								<div class="box alt">
										<div class="row uniform 50%">
											<div class="4u"><span class="image fit"><img src="images/architectural_diagram.png" alt="" /></span></div>
										</div>
								</div>

								<hr />
								<h3>Development plan, iterations and forks in prototypes</h3>
								<h4>Development plan</h4>
								As our client wanted to start development as soon as possible, the plan was to:
								<p>
								<ul>
									<li> Develop most of the front-end in Term 1. </li>
									<li> Initial plan was to access Drupal Database directly, but was not viable so we decided to make the Drupal website a Restful Web Service. </li>
									<li> Set-up the Drupal Rest API and configure it to get the needed data in Term 2. </li>
									<li> Improve Front-end to client specifications and testing throughout Term 2. </li>
									<li> Integrate the Back-end with the Front-end in Term 2. </li>
									<li> Continously test throught the development to ensure security of app and fast loading times in Term 2. </li>
									<li> Add user profiles to main website throughout Term 2.</li>
									<li> Move old data from old iNRIC website to new one towards the end of the term. </li>
								</ul>
								</p>
								<h4>Iterations and forks in prototypes</h4>
								<h5> First iteration </h5>
								<p>
								The first iteration of the app was the tabbed menu as well as the Home Page that implemented some design elements from the iNRIC website (font family, font size, title design, logo, etc). This proved to be very useful to show to our client and the iNRIC content manager how we envisioned the app and was more useful to do than focus on Photoshop Mock-ups as changes could easily be made within the CSS.
								</p>
								<h5> Second iteration </h5>
								<p>
								The second iteration of the app had complete example classes of most of the website. It contained Headlines, News, Recently added, Conferences, Training, etc and how they would present the information on the app. These example classes were very important to the future integration with our back-end. Furthermore, these classes needed to be checked by both the client and content manager as not as much information from the website could be shown in the app and as such some trade-offs needed to be made.
								</p>
								<h5> Third iteration </h5>
								<p>
								The third iteration implemented the Profile Page front-end which had no equivalent on the website and suffered multiple changes to be approved by the client. Furthermore, it included some design changes to the Searching page to accommodate searching with User Preferences as well.
								</p>
								<h5> Fourth iteration </h5>
								<p>
								Having the main part of the application done, we also created login, register and forgot password pages thus marking the end of the front-end design.
								</p>
								<h5> Fifth iteration </h5>
								<p>
								In our fifth iteration, we initially wanted to use PHP to access the Drupal Database directly but realised it was automatically generated and a lot more complicated than initially thought. Therefore we switched to making the Drupal iNRIC website as a REST API and therefore did a few AJAX requests (Headlines, News) to obtain some data.
								</p>
								<h5> Sixth iteration </h5>
								<p>
								Our sixth iteration was one of the longest ones, as we were unable to update Drupal to a newer version as it would interfere with the custom iNRIC built theme and we therefore had issues using the REST API as a login/logout tool. The main issue here was that although Drupal was logging the user in, it would still throw an error due to not being able to internally parse the JSON object it was sending back. We therefore had to go for a workaround that would still get the necessary login token and maintain it. This iteration created the ability for a user to log in/log out and for the user to be take back to the login page in case they weren't logged in.
								</p>
								<h5> Seventh iteration </h5>
								<p>
								The seventh iteration implemented the Headlines, Recent News, Latest Articles, Training, In Focus etc as AJAX requests instead of static data. Therefore, everytime the content manager will change something, the app will get updated.
								</p>
								<h5> Eighth iteration </h5> 
								<p> The eighth iteration implemented the Search Function AJAX request and integration with front-end as well as the Contribution web form.
								</p>
								<h5> Ninth iteration </h5>
								<p> The last iteration included the addition of the User Profile preferences as an AJAX request. </p>
								<h5> Forks on Github </h5>
								<p>
								Master initially contained the working front-end and node_module was created to test out adding the back-end AJAX requests.
								</p>
								<hr />
								<h3>Technical achievements, implementation details, use of design patterns</h3>
							
								<h4>Dependencies</h4>
								<p>
								The only dependency within our application for the front-end is the standard jQuery library as the app is written in native HTML5, CSS3, Javascript code due to the fact that the app needed to maintain the aspect of the iNRIC website.
								</p><p>A dependency for the use of the back-end is Drupal 7 as updating to Drupal 8 would fix some REST API errors that we provided a workaround for in our login/logout scripts.
								</p>
								<h4>Code Structure </h4>
								<p> The web-app code structure is presented below as Phonegap manages the files within the iOS and Android apps. </p>
								<ul>
									<li>www/login.html - Login Page with options to Registration and Forgotten Password</li>
									<li>www/register.html - Registration page with option to Login Page</li>
									<li>www/forgot.html - Forgot password via email page with option to Login Page </li>
									<li>www/index.html - Main tabbed application</li>
									<li>www/css/index.css - CSS3 Styles</li>
									<li>www/js/function.js - AJAX requests + Search, User preference, Contribution functions</li>
									<li>www/js/notifications.js - Android PushWoosh notifications</li>
								</ul>
								<h4>Front end</h4>
								<p> The front-end was built in native HTML5, CSS3, Javascript (with some uses of the jQuery library). We also used some UI Design patterns in order to create the front-end. With the main design, we conducted some A/B tests when choosing background and link colors as well as font size. Furthermore, we implemented the Prototype Design Pattern when creating the Front-end classes for articles, news, search results, etc and are called upon and inserted in the front-end by back-end Javascript functions.
								</p>
								<ul>
									<li><h5>Login Page</h5></li>
									<p>
									Contains a simple form that requests the user's email/username and password. It also contains a link to the "forgot password" page as well as the registration granting the user easy access to the app. CSS3 allows scaling on different screen resolutions.
									</p>
									<li><h5>Forgot Password Page</h5></li>
									<p>
									Contains a form that requires the user's email and a link to the login page. CSS3 also helps scale this on different screen resolutions.
									</p>
									<li> <h5>Register Page</h5></li>
									<p>
									Simple form for registration. Also scaled on different resolutions.
									</p>
									<li><h5>Index/ Main page</h5></li>
									<p>
									This page can only be accessed if login is succesful and contains the rest of the application. This page implements the Navigation Tab design pattern. We are hiding the content of the tab that is not used using jQuery. We are therefore loading the app all at once. The reason for this is to cut loading times when changing menu tabs. We are also implementing an Accordion Menu Design pattern for the Filters to not make the user scrolls through a lot of options. We are also using the Article List design pattern (show snippet of article to get user interest) when showing the headlines.
									</p>
								</ul>
								<h4>Back end</h4>
								<p>
								The iNRIC website (nric.org.uk) was developed in Drupal 7 and has a database of resources that is managed by Sue Wiseman (iNRIC Content Manager). The easiest way to ensure cross-platform utility on both the website and the app was to set up a RESTful Web Service (CRUD pattern) made with Drupal's Services as we wanted modifications made by the content manager to reflect on the app. This was not difficult to set-up, however it required tweaking in order to get the needed information (as we would get back html code that containted Drupal classes and would need parsing to adapt to our front-end). We are using JSON to send and get the necessary data. Furthermore the Services module is buggy and provided difficulty with login/logout scripts as well as authenticated requests (Error parsing json objects).
								</p>
								<h4>Back end integration with front-end</h4>
								<p>We are using Javascript functions that make AJAX requests to the RESTful API.</p>
								<ul>
									<li><h5>Login script</h5></li>
									<p>The login script is a POST AJAX request to the "/user/login" endpoint. It initially requests a CSRF(Cross-Site Request Forgery) token. It then sends the user details over HTTP and then produces a new CSRF token for further requests. It also produces a session cookie which is saved throughout the app in SessionStorage (to persist in PhoneGap app). We tried making the login request as HTTPS, however Drupal makes the whole website HTTPS, not just the REST API and produces errors with the theme. Security is not an issue if the theme of the main website gets fixed.</p>
									<p> The issue here with this script was that Drupal is throwing errors when sending back the JSON object, although the object is not corrupted. Therefore we are checking within the "errorthrown" JSON object for a 200 response status and session cookie.</p>
									<li><h5>Logout Script</h5></li>
									<p>The logout script is a POST AJAX request to the "/user/logout" endpoint. It uses the previously given CSRF token and the StorageSession cookie. The logout script presented the same JSON errors and is therefore using the same fix.</p>
									<li><h5>Searching Script</h5></li>
									<p>The searching script is a GET request to the "/views/resources?keys=" endpoint with keys being taken from the Searching form with Filters and Categories. This script uses the Iterator Design Pattern as it iterates through the filters and scripts on demand and selects the checked keys. It also iterates throught the returned JSON objects. It also makes use of the Prototype Design Pattern mentioned earlier in the front-end as it makes use of the classes created for the search results in the front-end and appends them in the HTML code of the page.
									</p>
									<li><h5> Quick Search and Update Profile </h5></li>
									<p>These two scripts work together, one by updating the User Preferences in the Drupal Database via a POST request to the "/user/uid" endpoint and the other getting the information from the User via a GET request from the same endpoint.</p>
									<li><h5>Headlines, Recent News, Latest Articles, Training, etc Scripts</h5></li>
									<p> These scripts are all GET requests to various endpoints from the Drupal API and return JSON objects that we iterate through. They also add the objects returned using the prototype CSS3 classes and divs. This allow the content manager to modify anything on the website to also show on the app.
									</p>
									<li><h5>Contribute, Register and Forgot Password Scripts</h5></li>
									<p> Are all POST requests that send form information to the REST API and append their responses to the HTML page. We would also need to change the protocotol to HTTPS here to maintain security. </p>
									<li><h5>Notifications</h5></li>
									<p> We are using <a href="https://www.pushwoosh.com">PushWoosh</a> in order to add Push Notifications, however we were unable to load the plugin on Phonegap Build. The reason for using PushWoosh is for the content manager to be able to send notifications when actually adding new resources to the website.</p>
								</ul>

								<h4>Database </h4>
								<p> The database is automatically generated by Drupal and is managed through the Drupal Configuration panel. We did not make any modifications to this as we used the Rest API services module that allowed us to select what we wanted to show via AJAX requests (CRUD operations).</p>
							</div>
						</section>
					</article>

				<!-- Footer -->
					<!-- Footer -->
					<footer id="footer">
						<ul class="icons">
							<li><a href="https://twitter.com/NRIC_Global" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
							<li><a href="https://www.facebook.com/NRIC-National-Resource-for-Infection-Control-322620358370/" class="icon fa-facebook"><span class="label">Facebook</span></a></li>
						</ul>
						<ul class="copyright">
							<li>&copy; Team 42 iNRIC</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
						</ul>
					</footer>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="assets/js/main.js"></script>

	</body>
</html>