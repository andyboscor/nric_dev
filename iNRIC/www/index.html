<!DOCTYPE html>
<!--
    Copyright (c) 2012-2014 Adobe Systems Incorporated. All rights reserved.

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
     KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.
-->
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />

        <title>iNRIC</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
         <script type="text/javascript">
         $(window).load(function(){
  if(!($("a#home").hasClass('active')))
    {
        $("a#home img#home").attr('src',"img/home.svg");
    }
    else {
        $("a#home img#home").attr('src',"img/homeactive.svg");
    }
});
         </script>
        <script type="text/javascript">
        $(document).ready(function(){
     $(".menu li a").click(function(){
    $('.menu li a').not(this).removeClass('active');
    $(this).addClass('active');
    if(!($("a#home").hasClass('active')))
    {
        $("a#home img#home").attr('src',"img/home.svg");
    }
    else {
        $("a#home img#home").attr('src',"img/homeactive.svg");
    }
    if(!($("a#search").hasClass('active')))
    {
        $("a#search img#search").attr('src',"img/search.svg");
    }
    else {
        $("a#search img#search").attr('src',"img/searchactive.svg");
    }
    if(!($("a#infocus").hasClass('active')))
    {
        $("a#infocus img#infocus").attr('src',"img/target.png");
    }
    else {
        $("a#infocus img#infocus").attr('src',"img/targetactive.png");
    }
    if(!($("a#links").hasClass('active')))
    {
        $("a#links img#links").attr('src',"img/links.svg");
    }
    else {
        $("a#links img#links").attr('src',"img/linksactive.svg");
    }
    if(!($("a#profile").hasClass('active')))
    {
        $("a#profile img#profile").attr('src',"img/profile.svg");
    }
    else {
        $("a#profile img#profile").attr('src',"img/profileactive.svg");
    };

/*
    if(!$("a img#home").hasClass("active"))
    { $("a img#home").attr('src',"img/home.svg");};
    $(".menu li a.active img#search").attr('src',"img/search.svg");
    $(".menu li a.active img#infocus").attr('src',"img/search.svg");
    $(".menu li a.active img#links").attr('src',"img/search.svg");
    $(".menu li a.active img#profile").attr('src',"img/search.svg"); */
 })
});</script>
<script>
function logout()
{
    var cookie = sessionStorage.sessname + "=" + sessionStorage.sessid;
    console.log(cookie);
    var err = false;
    var obj = "{\"Cookie\": \"" + cookie + "\" }";

$.ajax({
url: "http://139.162.199.80/nricrestapi/user/logout",
type: 'POST',
dataType: 'json',
contentType: 'application/json',
crossDomain: true,
async:false,
data: obj,
 beforeSend: function (request) {
        request.setRequestHeader("X-CSRF-Token", sessionStorage.token);
      }, 
error: function(XMLHttpRequest, textStatus, errorThrown) {
console.log(JSON.stringify(XMLHttpRequest));
console.log(textStatus);
console.log(errorThrown);
console.log(sessionStorage.token);
if (XMLHttpRequest.status == "200" )
    {    err = true;
        console.log(err);
    }
},
success: function (data) {
console.log('logout successful');
}

});
return err;
}
</script>
<script>
function searching(form)
{
    var err = false;
var obj = "test"; // search key
    $.ajax({
        url:"http://139.162.199.80/nricrestapi/views/latest_news",
        type: "get",
        crossDomain: true,
        async: false,  
        dataType: 'text',
        contentType: 'application/json',
        data: obj,
        error: function(jqXHR, textStatus, errorThrown) {
            console.log(jqXHR);
            console.log(textStatus);
            console.log(errorThrown);

        },
        success: function(data){
            data = JSON.parse($.trim(data));
            console.log(data);
            
            if (data.uid != null) {
                err = false;
                console.log(data);
            }
        }
    });
    return err;
};
function news()
{
    $.ajax({
        url:"http://139.162.199.80/nricrestapi/views/latest_news",
        type: "get",
        crossDomain: true,
        async: false,  
        dataType: 'text',
        contentType: 'application/json',
        data: '' ,
        error: function(jqXHR, textStatus, errorThrown) {
            console.log(jqXHR);
            console.log(textStatus);
            console.log(errorThrown);

        },
        success: function(data){
            data = JSON.parse($.trim(data));
            console.log(data);
            jQuery.each(data, function(i, val) {
                desiredLink = val.link;
                desiredText = val.title;
                //desiredDate = val.
            $('<div class="inner"><div class="title1"><a class="title2" href="#home" onclick="window.open(\''+desiredLink+'\', \'_blank\', \'location=yes\');">'+desiredText+'</a></div></div>').appendTo($('#latest_news'));
            });
            if (data.uid != null) {
              
                console.log(data);
            }
        }
    });
};
function recent()
{
    $.ajax({
        url:"http://139.162.199.80/nricrestapi/views/recently_added_resources",
        type: "get",
        crossDomain: true,
        async: false,  
        dataType: 'text',
        contentType: 'application/json',
        data: '' ,
        error: function(jqXHR, textStatus, errorThrown) {
            console.log(jqXHR);
            console.log(textStatus);
            console.log(errorThrown);

        },
        success: function(data){
            data = JSON.parse($.trim(data));
            console.log(data);
            jQuery.each(data, function(i, val) {
                if(i>5) return false;
                desiredLink = "http://139.162.199.80/node/" + val.nid;
                desiredText = val.title;
                desiredDate = val.node_created;
            $('<div class="inner"><div class="title1"><a class="title2" href="#home" onclick="window.open(\''+desiredLink+'\', \'_blank\', \'location=yes\');">'+desiredText+'</a><p class="data1">'+ desiredDate + '</p></div></div>').appendTo($('#recent'));
            
            //console.log(desiredLink);
            });
            if (data.uid != null) {
              
                console.log(data);
            }
        }
    });
};
function headline()
{
    $.ajax({
        url:"http://139.162.199.80/nricrestapi/views/headlines",
        type: "get",
        crossDomain: true,
        async: false,  
        dataType: 'text',
        contentType: 'application/json',
        data: '' ,
        error: function(jqXHR, textStatus, errorThrown) {
            console.log(jqXHR);
            console.log(textStatus);
            console.log(errorThrown);

        },
        success: function(data){
            data = JSON.parse($.trim(data));
            console.log(data);
            jQuery.each(data, function(i, val) {
                if(i>5) return false;
                desiredLink = "http://139.162.199.80/node/" + val.nid;
                desiredText = val.title;
                desiredData = val.body;
                var find = '<p>﻿﻿﻿﻿﻿</p>';
                var re = new RegExp(find, 'g');
                desiredData = desiredData.replace(re, '');
                var find2 = '<p>';
                var re2 = new RegExp(find2, 'g');
                desiredData = desiredData.replace(re2, '<p class="data">');
                var find3 = '<div>';
                var re3 = new RegExp(find3, 'g');
                desiredData = desiredData.replace(re3, '');
                var find4 = '</div>';
                var re4 = new RegExp(find4, 'g');
                desiredData = desiredData.replace(re4, '');
                //desiredData.replace(/'<p>'/g,'');
                console.log(desiredData);
            $('<div class="inner"><div class="title1"><a class="title" href="#home" onclick="window.open(\''+desiredLink+'\', \'_blank\', \'location=yes\');">'+desiredText+'</a>'+ desiredData + '</div></div>').appendTo($('#headlines'));
            

            //console.log(desiredLink);
            });
            if (data.uid != null) {
              
                console.log(data);
            }
        }
    });
};
$( document ).ready(function() {
    news();
    recent();
    headline();
});
</script>
<!-- Adding an in app-browser link is done with an <a> tag. href is set to "#home or #search". 
onclick = "window.open('http://google.com', '_blank', 'location=yes');"-->
    </head>
    <body>
        <!-- Logo  -->
        <header class="logoheader">
            <div class="logodiv">
                <img class="logo" src="img/logo.png">
            </div>
        </header>

        <div class="section" id="home">
            <h2 class="block-title"> Headlines </h2>
            <div  id="headlines">
            <!-- <div class="inner">
                <div class="title1">
                    <a class="title" href="#home" onclick="window.open('http://www.who.xint/campaigns/aids-day/2015/en/', '_blank', 'location=yes');"> World AIDS Day 2015: Getting to Zero </a>
                
                    <p class="data"> On World AIDS Day WHO emphasizes that expanding antiretroviral therapy to all people living with HIV is key to ending the AIDS epidemic within a generation. </p>
                </div>
            </div>
            <div class="inner">
                <div class="title1">
                    <a class="title" href="http://www.who.int/campaigns/aids-day/2015/en/">European Anitbiotic Awareness Day (EAAD) 18 November 2015 </a>

                    <p class="data"> On World AIDS Day WHO emphasizes that expanding antiretroviral therapy to all people living with HIV is key to ending the AIDS epidemic within a generation. </p>
                </div>
            </div>
            -->
            </div>
            </div>
            
            <h2 class="block-title"> Latest News </h2>
            <div  id="latest_news">
            <!--
            <div class="inner">
                <div class="title1">
                    <a class="title2" href="http://www.who.int/campaigns/aids-day/2015/en/">European Anitbiotic Awareness Day (EAAD) 18 November 2015 </a>

                    <p class="data1"> 12/7/25 </p>
                </div>

            </div>
            -->
            </div>
            <h2 class="block-title"> Recent</h2>
            <div id="recent">
            <!--
            <div class="inner">
                <div class="title1">
                    <a class="title2" href="http://www.who.int/campaigns/aids-day/2015/en/">World AIDS Day 2015: Getting to Zero </a>

                    <p class="data1"> 12/7/25 </p>
                </div>
            </div>

            <div class="inner">
                <div class="title1">
                    <a class="title2" href="http://www.who.int/campaigns/aids-day/2015/en/">European Anitbiotic Awareness Day (EAAD) 18 November 2015 </a>

                    <p class="data1"> 12/7/25 </p>
                </div>
            </div>
            -->
            </div>
            <div class="filler"> </div>
        </div>
        <div class="section" id="search">

            <div class="normalform" style="margin-top:4vh;">
            <form method="" onclick="searching(this); return false;" accept-charset="utf-8">
               <input type="search" name="search" placeholder="Search..." required>
               <p> </p>

               <select name="category">
                <option value="">Category...</option>
                <option value="Afganistan">Disease</option>
                <option value="Afganistan">Aerial</option>
            </select>
            <input type="submit" value="Search">
            </form>
        </div>
        <h2 class="block-title"> Filters </h2>
        <div class="dropdown">
            <input type="checkbox" id="checkbox_toggle" class="menu">
            <label for="checkbox_toggle">Region </label><img class="closed" src="img/a-left.png"></img><img class="down" src="img/a-down.png"></img>
            <ul id="drop">
                <li class="drop"><input type="checkbox" id="check1"><label for="check1">Africa</label></li>
                <li class="drop"><input type="checkbox" id="check2"><label for="check2">North America</label></li>
                <li class="drop"><input type="checkbox" id="check3"><label for="check3">South America</label></li>
                <li class="drop"><input type="checkbox" id="check4"><label for="check4">Asia</label></li>
                <li class="drop"><input type="checkbox" id="check5"><label for="check5">Europe</label></li>
                <li class="drop"><input type="checkbox" id="check6"><label for="check6">Oceania</label></li>
            </ul>
        </div>
        <div class="dropdown">
            <input type="checkbox" id="checkbox_toggle2" class="menu">
            <label for="checkbox_toggle2">Diseases </label><img class="closed" src="img/a-left.png"></img><img class="down" src="img/a-down.png"></img>
            <ul id="drop">
                <li class="drop"><input type="checkbox" id="check1"><label for="check1">Africa</label></li>
                <li class="drop"><input type="checkbox" id="check2"><label for="check2">North America</label></li>
                <li class="drop"><input type="checkbox" id="check3"><label for="check3">South America</label></li>
                <li class="drop"><input type="checkbox" id="check4"><label for="check4">Asia</label></li>
                <li class="drop"><input type="checkbox" id="check5"><label for="check5">Europe</label></li>
                <li class="drop"><input type="checkbox" id="check6"><label for="check6">Oceania</label></li>
            </ul>
        </div>
        <div class="dropdown">
            <input type="checkbox" id="checkbox_toggle3" class="menu">
            <label for="checkbox_toggle3">Diseases </label><img class="closed" src="img/a-left.png"></img><img class="down" src="img/a-down.png"></img>
            <ul id="drop">
                <li class="drop"><input type="checkbox" id="check1"><label for="check1">Africa</label></li>
                <li class="drop"><input type="checkbox" id="check2"><label for="check2">North America</label></li>
                <li class="drop"><input type="checkbox" id="check3"><label for="check3">South America</label></li>
                <li class="drop"><input type="checkbox" id="check4"><label for="check4">Asia</label></li>
                <li class="drop"><input type="checkbox" id="check5"><label for="check5">Europe</label></li>
                <li class="drop"><input type="checkbox" id="check6"><label for="check6">Oceania</label></li>
            </ul>
        </div>
        <h2 class="block-title"> Contribute </h2>
         <div class="normalform" style=" ">

               <input type="name" name="search" placeholder="Add title" required>
            
            <input type="submit" value="Add">
        </div>
       <div class="filler"> </div>
    </div>
    <div class="section" id="infocus">
        <h2 class="block-title"> In Focus </h2>
        <p>Static data</p>
        <h2 class="block-title"> Training </h2>
        <p>Static data</p>
    </div>
    <div class="section" id="links">
        <h2 class="block-title"> Conferences </h2>
        <p> Static Data </p>
        <h2 class="block-title"> Useful links </h2>
        <p> Static Data </p>
    </div>
    <div class="section" id="profile">
        <div class="profile_name">
        Dr. Patty Kostkova
        <a class="email"> p.kostkova@ucl.ac.uk </a>
        </div>
        <div class="settings">
        <h2 class="block-title"> Filters </h2>
        </div>
                    
         <div class="dropdown">
            <input type="checkbox" id="checkbox_toggle_4" class="menu">
            <label for="checkbox_toggle_4">Region </label><img class="closed" src="img/a-left.png"></img><img class="down" src="img/a-down.png"></img>
            <ul id="drop">
                <li class="drop"><input type="checkbox" id="check1"><label for="check1">Africa</label></li>
                <li class="drop"><input type="checkbox" id="check2"><label for="check2">North America</label></li>
                <li class="drop"><input type="checkbox" id="check3"><label for="check3">South America</label></li>
                <li class="drop"><input type="checkbox" id="check4"><label for="check4">Asia</label></li>
                <li class="drop"><input type="checkbox" id="check5"><label for="check5">Europe</label></li>
                <li class="drop"><input type="checkbox" id="check6"><label for="check6">Oceania</label></li>
            </ul>
        </div>
        <div class="dropdown">
            <input type="checkbox" id="checkbox_toggle4" class="menu">
            <label for="checkbox_toggle4">Diseases </label><img class="closed" src="img/a-left.png"></img><img class="down" src="img/a-down.png"></img>
            <ul id="drop">
                <li class="drop"><input type="checkbox" id="check1"><label for="check1">Africa</label></li>
                <li class="drop"><input type="checkbox" id="check2"><label for="check2">North America</label></li>
                <li class="drop"><input type="checkbox" id="check3"><label for="check3">South America</label></li>
                <li class="drop"><input type="checkbox" id="check4"><label for="check4">Asia</label></li>
                <li class="drop"><input type="checkbox" id="check5"><label for="check5">Europe</label></li>
                <li class="drop"><input type="checkbox" id="check6"><label for="check6">Oceania</label></li>
            </ul>
        </div>
        <input type="button" class="save" value="Save" />
       
        <h2 class="block-title"> Email </h2>
        <div class="normalform">

               <input type="mail" name="search" placeholder="email@domain.com" required>
               
            <input type="submit" value="Save">
        </div>
        <h2 class="block-title"> Country </h2>
        <div class="normalform">
               <select name="category">
                <option value="">Category...</option>
                <option value="Afganistan">Disease</option>
                <option value="Afganistan">Aerial</option>
            </select>
            <input type="submit" value="Change">
        </div>
        <h2 class="block-title"> Password </h2>
        <div class="normalform">

               <input type="password" name="search" placeholder="Change Password..." required>
            
            <input type="submit" value="Change">
        </div>
        <input type="button" class="logout" onclick="if(logout() == true) window.location='login.html';" value="Log out" />
    </div>
    <footer>
        <div class="menu" >
            <nav>
                <ul><li class="inactive"><a id="home" href="#home" class="active"><img id="home" src="img/home.svg" class="inactiveimg"></img><br>Home</br></a></li>
                    <li class="inactive"><a id="search"href="#search"><img id="search" src="img/search.svg" class="inactiveimg"></img><br>Search</br></a></li>
                    <li class="inactive"><a id="infocus" href="#infocus"><img id="infocus" src="img/target.png" class="inactiveimg"></img><br>In Focus</br></a></li>
                    <li class="inactive"><a id="links" href="#links"><img id="links" src="img/links.svg" class="inactiveimg"></img><br>links</br></a></li>
                    <li class="last inactive"><a id="profile" href="#profile"><img id="profile" src="img/profile.svg" class="inactiveimg"></img><br>Profile</br></a></li>
                </ul>
            </nav>
        </div>
    </footer>  
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript">
        app.initialize();
    </script>
</body>
</html>
